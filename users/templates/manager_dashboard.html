<!DOCTYPE html>
<html>
<head>
    <title>Employee Dashboard</title>
    <!-- Include Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<!--    <link rel="stylesheet" href="css/styles.css">-->
    <style>
        /* Custom CSS for font color */
        .employee-dashboard-title {
            color: blue;
        }
        /* Style for the logout button */
        .logout-button {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .small-search-form {
            max-width: 300px;
        }
        .small-search-button {
            width: 100px;
        }
                .search-filter {
            display: flex;
            justify-content: flex-end;
        }
    </style>
</head>
<body style="background-color: #fff;">
    <div class="container mt-5">
        <a href="{{ url_for('login_bp.logout') }}" class="btn btn-danger logout-button">Logout</a>
        <div class="col-md-12 text-center">
            <h2 class="mb-4 employee-dashboard-title">Employee Management | Role: {{current_user.role|capitalize}}</h2>
        </div>
        <div class="card">
            <div class="card-body">
                <br>
                <h3><b>Employees</b></h3>
                <br>
                <div class="search-filter">
                    <form method="POST" action="{{ url_for('employee_bp.search_employees') }}" class="small-search-form input-group">
                        <input type="text" class="form-control" name="search" placeholder="Search...">
                        <div class="input-group-append">
                            <button type="submit" class="btn btn-primary small-search-button">Search</button>
                        </div>
                    </form>
                    <button type="button" class="btn btn-secondary ml-2" data-toggle="modal" data-target="#filterModal">Filter</button>
                </div>
        <div class="row">
            <div class="col-md-6 text-right">
                <a href="{{ url_for('employee_bp.create_employee') }}" class="btn btn-primary">Create Employee</a>
                <a href="{{ url_for('export_bp.export', export_type='csv') }}" class="btn btn-success">Export CSV</a>
                <a href="{{ url_for('export_bp.export', export_type='xlsx') }}" class="btn btn-success">Export XLSX</a>
                <a href="{{ url_for('export_bp.export', export_type='json') }}" class="btn btn-success">Export JSON</a>
            </div>
<br>
            <!-- Modal for employee filter -->
    <div class="modal fade" id="filterModal" tabindex="-1" role="dialog" aria-labelledby="filterModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="filterModalLabel">Filter Employees</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="POST" action="{{ url_for('employee_bp.filter_employees') }}">
                        <div class="form-group">
                            <label for="designation">Designation</label>
                            <select class="form-control" id="designation" name="designation">
                                <option value="">Select Designation</option>
                                {% for each in designation_choices %}
                                <option value="{{each[0]}}">{{each[1]}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="department">Department</label>
                            <select class="form-control" id="department" name="department">
                                <option value="">Select Department</option>
                                {% for each in department_choices %}
                                <option value="{{each[0]}}">{{each[1]}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Apply Filter</button>
                    </form>
                </div>
            </div>
        </div>
            </div>
        <br>
        <!-- Employee table -->
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Manager</th>
                    <th>Designation</th>
                    <th>Department</th>
                    <th>Action</th> <!-- Column for Edit and Delete buttons -->
                </tr>
            </thead>
            <tbody>
                {% for employee in employees %}
                <tr>
                    <td><a href="{{ url_for('employee_bp.employee_detail', employee_id=employee._id) }}">{{ employee.name }}</a></td>
                    <td>{{ employee.email }}</td>
                    <td>{{ employee.phone }}</td>
                    <td>{{ employee.manager_name }}</td>
                    <td>{{ employee.designation }}</td>
                    <td>{{ employee.department }}</td>
                    <td>
                        <a href="{{ url_for('employee_bp.edit_employee', employee_id=employee._id) }}" class="btn btn-warning btn-sm">Edit</a>
                        <a href="#" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#confirmationModal {{ employee._id }}" data-employee-id="{{ employee._id }}">Delete</a>

                    </td>
                </tr>
                <div class="modal fade" id="confirmationModal {{ employee._id }}" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel {{ employee._id }}" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="confirmationModalLabel {{ employee._id }}">Confirmation</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete this employee?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <a id="confirmDelete" class="btn btn-danger" href="{{ url_for('employee_bp.delete_employee', employee_id=employee._id) }}">Delete</a>
                        </div>
                    </div>
                </div>
            </div>
                {% endfor %}
            </tbody>
        </table>
    </div>
            </div>
        </div>
    </div>
</div>


<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>




</body>
</html>

